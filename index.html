<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Duyuru Wordle</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 40px;
    }
    h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(5, 50px);
      grid-gap: 5px;
      margin-top: 20px;
    }
    .cell {
      width: 50px;
      height: 50px;
      border: 2px solid #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      background: #fff;
    }
  </style>
</head>
<body>
  <h1>DUYURU WORDLE <span id="version">v0.1</span></h1>

  <div id="board"></div>

  <script>
    // --- Ayarlar ---
    const WORDS = [
      "KEMER", "KASIM", "KARGO", "BASIN", "TATIL", "GOLGE", "MIZIK", "SESLI",
      "BARDA", "TURKU", "KOZAN", "TASLI", "DURUM", "KAPAK", "KAYGI", "YARIM"
    ];

    const STORAGE_KEY = "dw_used_words";
    const MAX_MEMORY_DAYS = 90; // 3 ay

    // --- Kullanılmış kelimeleri getir ---
    function loadUsedWords() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return [];
      try {
        const parsed = JSON.parse(raw);
        const cutoff = Date.now() - MAX_MEMORY_DAYS * 24*60*60*1000;
        // 3 aydan eski kayıtları temizle
        return parsed.filter(item => item.time > cutoff);
      } catch(e) {
        return [];
      }
    }

    function saveUsedWord(word) {
      const list = loadUsedWords();
      list.push({ word, time: Date.now() });
      localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
    }

    // --- Bugünün kelimesi ---
    function selectDailyWord() {
      const today = new Date();
      const key = `dw_word_${today.getFullYear()}_${today.getMonth()+1}_${today.getDate()}`;

      // Daha önce seçilmişse onu kullan
      const existing = localStorage.getItem(key);
      if (existing) return existing;

      // Kullanılmamış kelimeleri filtrele
      const used = loadUsedWords().map(x => x.word);
      const available = WORDS.filter(w => !used.includes(w));

      // Eğer hepsi kullanıldıysa yeniden sıfırla
      const pool = available.length > 0 ? available : WORDS;

      // Rastgele seç
      const chosen = pool[Math.floor(Math.random() * pool.length)];

      // Bugün için kaydet
      localStorage.setItem(key, chosen);

      // Kullanılmış kelimelere ekle
      saveUsedWord(chosen);

      return chosen;
    }

    const TODAY_WORD = selectDailyWord();
    console.log("Today's Word:", TODAY_WORD);

    // --- Basit 5x6 board çizimi ---
    const board = document.getElementById("board");
    for (let i = 0; i < 30; i++) {
      const div = document.createElement("div");
      div.className = "cell";
      board.appendChild(div);
    }
  </script>
</body>
</html>
